

<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Home-Assignment-1-(20-points)">Home Assignment 1 (20 points)<a class="anchor-link" href="#Home-Assignment-1-(20-points)">¶</a></h1><p>Submit your solutions in teams of 5 students. Unless explicitly agreed otherwise in advance, <strong>submissions from teams with more or less members will NOT be graded</strong>.
List all members of the team with their student ID in the cell below, and submit only one notebook per team. Only submit a notebook, do not submit the dataset(s) you used. Also, do NOT compress/zip your submission!</p>
<p>You may use the code from the exercises and basic functionalities that are explained in official documentation of Python packages without citing, <strong>all other sources must be cited</strong>. In case of plagiarism (copying solutions from other teams or from the internet) ALL team members may be expelled from the course without warning.</p>
<h4 id="General-guidelines:">General guidelines:<a class="anchor-link" href="#General-guidelines:">¶</a></h4><ul>
<li>Make sure that your code is executable, any task for which the code does not directly run on our machine will be graded with 0 points. We use the conda environment given below.</li>
<li>If you use packages that are not available on the default or conda-forge channel, list them below. Also add a link to installation instructions. </li>
<li>Ensure that the notebook does not rely on the current notebook or system state!<ul>
<li>Use <code>Kernel --&gt; Restart &amp; Run All</code> to see if you are using any definitions, variables etc. that 
are not in scope anymore.</li>
<li>Do not rename any of the datasets you use, and load it from the same directory that your ipynb-notebook is located in, i.e., your working directory.</li>
</ul>
</li>
<li>Make sure you clean up your code before submission, e.g., properly align your code, and delete every line of code that you do not need anymore, even if you may have experimented with it. Minimize usage of global variables. Avoid reusing variable names multiple times!</li>
<li>Ensure your code/notebook terminates in reasonable time.</li>
<li>Feel free to use comments in the code. While we do not require them to get full marks, they may help us in case your code has minor errors.</li>
<li>For questions that require a textual answer, please do not write the answer as a comment in a code cell, but in a Markdown cell below the code. Always remember to provide sufficient justification for all answers.</li>
<li>You may create as many additional cells as you want, just make sure that the solutions to the individual tasks can be found near the corresponding assignment.</li>
<li>If you have any general question regarding the understanding of some task, do not hesitate to post on Slack, so we can clear up such questions for all students in the course.</li>
</ul>
<p>Conda environment used for grading:</p>

<pre><code>yml
name: nlp-ss2024
channels:
  - defaults
dependencies:
  - python=3.11
  - pip
  - pip:
    - numpy==1.26.4
    - nltk==3.8.1
    - scikit-learn==1.4.2
    - scipy==1.13.0
    - notebook</code></pre>
<h3 id="AI-Disclosure">AI Disclosure<a class="anchor-link" href="#AI-Disclosure">¶</a></h3><ul>
<li>Did you use any AI assistance to complete this homework? If so, please also specify what AI you used.<ul>
<li><em>your response here</em></li>
</ul>
</li>
</ul>
<hr>
<p><em>(only complete the below questions if you answered yes above)</em></p>
<ul>
<li>If you used a large language model to assist you, please paste <em>all</em> of the prompts that you used below. Add a separate bullet for each prompt, and specify which problem is associated with which prompt.<ul>
<li><em>your response here</em></li>
</ul>
</li>
<li><strong>Free response</strong>: For each problem for which you used assistance, describe your overall experience with the AI. How helpful was it? Did it just directly give you a good answer, or did you have to edit it? Was its output ever obviously wrong or irrelevant? Did you use it to get the answer or check your own answer?<ul>
<li><em>your response here</em></li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># UMR Usernames of all group members (&lt;Username&gt;@students.uni-marburg.de)</span>
<span class="n">team_members</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">"Student1"</span><span class="p">,</span>
    <span class="s2">"Student2"</span><span class="p">,</span>
    <span class="s2">"..."</span>
<span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Additional packages (if any):</p>
<ul>
<li>Example: <code>powerlaw</code>, <a href="https://github.com/jeffalstott/powerlaw">https://github.com/jeffalstott/powerlaw</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Tuple</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Task-1:-Regular-expressions">Task 1: Regular expressions<a class="anchor-link" href="#Task-1:-Regular-expressions">¶</a></h3><p>In this task you are asked to create regular expressions that meet the specified conditions. Please use the <code>re</code> package for the following subtasks.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import the re package</span>
<span class="kn">import</span> <span class="nn">re</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>a)</strong> Write a regular expression that returns all integer numbers from a text that are surrounded by whitespaces.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># your code here</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>b)</strong> Write a regular expression that returns all valid years that are surrounded by whitespaces in a text. A valid year is a 4 digit number in the range from 0000 to 2022. You do not need to account for overlaps, e.g., <code>' 2023 2024 ' =&gt; [2023]</code> is ok. Bonus points if you do so (<code>' 2023 2024 ' =&gt; [2023,2024]</code>).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># your code here</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>c)</strong> Write a regular expression that returns all dates in the format YYYY-MM-DD or YYYY/MM/DD from a given text. Make sure that YYYY is a valid year (see task <strong>b)</strong>), MM is a valid month (01 to 12) and DD is a valid day (01 to 31).
There is no need to make sure that e.g. XXXX-02-31 does not exist.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># your code here</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>d)</strong> Assume you are given a list <code>l</code> of strings like the one below. Using regular expressions, return a list that contains all elements from <code>l</code> that don't contain both, the letter <code>a</code> and <code>e</code> and store the result in a variable <code>l_filtered</code>.</p>
<p><strong>Example:</strong> <em>given the list</em></p>
<p><code>l = ["apple", "cucumber", "tomato", "zucchini", "pumpkin", "pear", "raspberry", "blueberry"]</code></p>
<p><em>you should return</em></p>
<p><code>l_filtered = ['cucumber', 'tomato', 'zucchini', 'pumpkin', 'blueberry']</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># example list</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"apple"</span><span class="p">,</span> <span class="s2">"cucumber"</span><span class="p">,</span> <span class="s2">"tomato"</span><span class="p">,</span> <span class="s2">"zucchini"</span><span class="p">,</span> <span class="s2">"pumpkin"</span><span class="p">,</span> <span class="s2">"pear"</span><span class="p">,</span> <span class="s2">"raspberry"</span><span class="p">,</span> <span class="s2">"blueberry"</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># your code here</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>e)</strong> For the given string <code>s</code> with 4 lines, change the <em>whole</em> word <code>pot</code> (i.e. <code>pottery</code> should not be changed) to <code>1234</code> only if it is at the start of a line.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="s1">'''</span><span class="se">\</span>
<span class="s1">pottery clot pot</span>
<span class="s1">pot dot plot hot</span>
<span class="s1">spot rot pot got</span>
<span class="s1">not shot forgot'''</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># your code here</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Task-2:-Finding-the-most-similar-word">Task 2: Finding the most similar word<a class="anchor-link" href="#Task-2:-Finding-the-most-similar-word">¶</a></h3><p>The goal of this task is, given a corpus, to find the most similar word for a provided word. As an example we will consider the King James Bible that is is included in the <code>gutenberg</code> corpus and we are looking to find the word that is most similar to <code>god</code>. We consider two words similar if they appear in the same word context.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>a) Cleaning the input</strong></p>
<p>Write a function that, given a list of tokens, returns a list of tokens that we consider valid for our task. Moreover, all input tokens should be converted to lower case.</p>
<p>An <em>invalid</em> token is a token that</p>
<ul>
<li>is a punctuation mark (consider <code>string.punctuation</code>).</li>
<li>is entirely numeric digits (e.g. <code>"123"</code>)</li>
<li>optionally, if <code>remove_stopwords=True</code> then stopwords in the English language are also not considered valid tokens (use nltk's stopwords). </li>
</ul>
<p>Use the function signature specified in the cell below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
<span class="kn">from</span> <span class="nn">nltk.corpus.reader.util</span> <span class="k">import</span> <span class="n">StreamBackedCorpusView</span>

<span class="k">def</span> <span class="nf">get_valid_tokens</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">StreamBackedCorpusView</span><span class="p">],</span> <span class="n">remove_stopwords</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
    <span class="sd">"""</span>
<span class="sd">    :param tokens: list of tokens that should be cleaned</span>
<span class="sd">    :param remove_stopwords: bool indicating if stopwords should be removed</span>
<span class="sd">                             False by default</span>
<span class="sd">    :return: list of valid tokens</span>
<span class="sd">    """</span>
    <span class="c1"># your code here</span>
    <span class="k">return</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>b) Counting the surroundings</strong></p>
<p>In our simple model of word similarity we consider words as similar if they are being used in the same context (i.e. they have similar words surrounding them).</p>
<p>Implement a function that, given a list of words, returns the count of all words in a designated word's surrounding. The context size indicates how many words to the left and right we consider, i.e. a context size of 1 indicates that we only consider the words immediately before and after a central word to be in its context.</p>
<p>Your function should return a dictionary which maps each word <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.598em, 1000.69em, 2.412em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 0.683em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">w</script> from the input list to a dictionary. The inner dictionary should map each word that appears in the context of the central word <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.598em, 1000.69em, 2.412em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 0.683em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">w</script> to a number that indicates how often it appears in the context of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.598em, 1000.69em, 2.412em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 0.683em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">w</script>.</p>
<p>Make sure your implementation has linear complexity in the vocabulary / corpus length. Use the function signature specified in the cell below.</p>
<p><strong>Hint:</strong> Instead of the inner dictionary you can alternatively use <code>Counter</code> or <code>defaultdict</code> which can be found in the Python module <code>collections</code>. Moreover, consider the function <code>ngrams</code> from <code>nltk</code>.</p>
<p><strong>Example:</strong> <em>For the input</em>
<code>['hi', 'james', 'how', 'are', 'you', 'hello', 'catherine', 'how', 'are', 'you']</code> <em>and</em> <code>context_size=1</code>
<em>we wish to obtain:</em></p>

<pre><code>{'hi': {'james': 1},
 'james': {'hi': 1, 'how': 1},
 'how': {'james': 1, 'are': 2, 'catherine': 1},
 'are': {'how': 2, 'you': 2},
 'you': {'are': 2, 'hello': 1},
 'hello': {'you': 1, 'catherine': 1},
 'catherine': {'hello': 1, 'how': 1}}</code></pre>
<p><strong>Explanation:</strong> <em>The word</em> <code>hi</code> <em>is only surrounded by</em> <code>james</code><em>. The word</em> <code>james</code> <em>is surrounded by</em> <code>hi</code> <em>and</em> <code>how</code> <em>. The word</em> <code>how</code> <em>is surrounded by</em> <code>james</code><em>, by</em> <code>catherine</code> <em>and by</em> <code>are</code> <em>twice, ...</em></p>
<p><em>For</em> <code>contextsize=2</code> <em>we obtain:</em></p>

<pre><code>{'hi': {'james': 1, 'how': 1},
'james': {'hi': 1, 'how': 1, 'are': 1},
'how': {'are': 2, 'you': 2, 'hi': 1, 'james': 1, 'hello': 1, 'catherine': 1},
'are': {'how': 2, 'you': 2, 'james': 1, 'hello': 1, 'catherine': 1},
'you': {'how': 2, 'are': 2, 'hello': 1, 'catherine': 1},
'hello': {'are': 1, 'you': 1, 'catherine': 1, 'how': 1},
'catherine': {'you': 1, 'hello': 1, 'how': 1, 'are': 1}}</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">get_surrounding_counts</span><span class="p">(</span><span class="n">tokens</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">StreamBackedCorpusView</span><span class="p">],</span> <span class="n">context_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sd">"""</span>
<span class="sd">    :param tokens: list of tokens</span>
<span class="sd">    :param context_size: integer that indicates the number of context words that are considered on both sides of the central word</span>
<span class="sd">    :return: dict of dicts that holds the count of context words for each input token</span>
<span class="sd">    """</span>
    <span class="c1"># your code here</span>
    <span class="k">return</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>c) Keeping the top <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 0.647em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.527em; height: 0px; font-size: 122%;"><span style="position: absolute; clip: rect(1.355em, 1000.51em, 2.411em, -1000em); top: -2.225em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.225em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">k</script> words in context</strong></p>
<p>To reduce the size of our result from task <strong>b)</strong>, we will only consider the most frequent context words for each token. Therefore, write a function that keeps only the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.54em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.347em, 1000.52em, 2.412em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 0.982em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">k</script> most frequent words in the context of a designated word. Ties are resolved in lexicographic order (e.g. <em><strong>A</strong>braham</em> would be preferred to <em><strong>B</strong>ethlehem</em>). The function should return a dictionary that maps each word in the outer dictionary to a <strong>set</strong> of their top <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 0.663em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.54em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.347em, 1000.52em, 2.412em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="mi" id="MathJax-Span-18" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 0.982em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">k</script> most frequent context words.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">to_sets</span><span class="p">(</span><span class="n">context_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n">k</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
    <span class="sd">"""</span>
<span class="sd">    :param context_dict: dict of dicts that holds the count of context words for each word</span>
<span class="sd">    :param k: integer that specifies how many context words should be kept</span>
<span class="sd">    :return: dict that maps each word to a set of its k most frequent context words</span>
<span class="sd">    """</span>
    <span class="c1"># your code here</span>
    <span class="k">return</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>d) Finding the most similar words</strong></p>
<p>Given a dictionary as obtained in task <strong>c)</strong> and a word <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-19" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.598em, 1000.69em, 2.412em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-20"><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 0.683em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">w</script>, we want to find the words that have the highest similarity to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-22" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.598em, 1000.69em, 2.412em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-23"><span class="mi" id="MathJax-Span-24" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 0.683em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-8">w</script> in terms of their context. We operationalize context similarity with the Jaccard index (<a href="https://en.wikipedia.org/wiki/Jaccard_index">https://en.wikipedia.org/wiki/Jaccard_index</a>).
The Jaccard index of two sets <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-25" style="width: 0.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.78em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.325em, 1000.76em, 2.401em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-26"><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.071em; border-left: 0px solid; width: 0px; height: 0.995em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-9">A</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>B</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 0.963em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.78em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.358em, 1000.78em, 2.401em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Math; font-style: italic;">B</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.071em; border-left: 0px solid; width: 0px; height: 0.956em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>B</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">B</script> (in our case the sets of context words) is defined as:</p>
<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>J</mi><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mfrac><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>A</mi><mo>&amp;#x2229;</mo><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow><mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>A</mi><mo>&amp;#x222A;</mo><mi>B</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow></mrow></mfrac></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-31" style="width: 8.406em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.023em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(0.972em, 1007.02em, 3.09em, -1000em); top: -2.281em; left: 0em;"><span class="mrow" id="MathJax-Span-32"><span class="mi" id="MathJax-Span-33" style="font-family: MathJax_Math; font-style: italic;">J<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.078em;"></span></span><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-37" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">B</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mfrac" id="MathJax-Span-40" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.052em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.311em, 1001.85em, 4.378em, -1000em); top: -4.62em; left: 50%; margin-left: -0.966em;"><span class="mrow" id="MathJax-Span-41"><span class="texatom" id="MathJax-Span-42"><span class="mrow" id="MathJax-Span-43"><span class="mo" id="MathJax-Span-44" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-45" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-46" style="font-size: 70.7%; font-family: MathJax_Main;">∩</span><span class="mi" id="MathJax-Span-47" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span class="texatom" id="MathJax-Span-48"><span class="mrow" id="MathJax-Span-49"><span class="mo" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(3.311em, 1001.85em, 4.378em, -1000em); top: -3.569em; left: 50%; margin-left: -0.966em;"><span class="mrow" id="MathJax-Span-51"><span class="texatom" id="MathJax-Span-52"><span class="mrow" id="MathJax-Span-53"><span class="mo" id="MathJax-Span-54" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-55" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Main;">∪</span><span class="mi" id="MathJax-Span-57" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">B</span><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mo" id="MathJax-Span-60" style="font-size: 70.7%; font-family: MathJax_Main;">|</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.022em;"></span></span><span style="position: absolute; clip: rect(0.825em, 1002.05em, 1.261em, -1000em); top: -1.3em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.052em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.08em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.281em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.82em; border-left: 0px solid; width: 0px; height: 2.235em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>J</mi><mo stretchy="false">(</mo><mi>A</mi><mo>,</mo><mi>B</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>A</mi><mo>∩</mo><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>A</mi><mo>∪</mo><mi>B</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-11">J(A, B) = \frac{|A \cap B|}{|A \cup B|}</script></p>
<p>Write a function that returns the words that have the highest similarity to an input word <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-61" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.598em, 1000.69em, 2.412em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-62"><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 0.683em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">w</script> (ignoring the input word itself). Since several words may have the same Jaccard similarity to the input word, your function should return the set of words that are most similar to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>w</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-64" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.72em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.598em, 1000.69em, 2.412em, -1000em); top: -2.221em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.221em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.085em; border-left: 0px solid; width: 0px; height: 0.683em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">w</script> and the respective value of the Jaccard similarity. Use the function signature specified in the cell below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">find_most_similar_words</span><span class="p">(</span><span class="n">input_word</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">contexts</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">float</span><span class="p">]:</span>
    <span class="sd">"""</span>
<span class="sd">    :param input_word: string that represents the word we are interested in</span>
<span class="sd">    :param contexts: dict that maps each word to a set of its most frequent context words</span>
<span class="sd">    :returns:</span>
<span class="sd">        - set of the most similar words to the input word</span>
<span class="sd">        - float that indicates the highest Jaccard similarity to the input word</span>
<span class="sd">    """</span>
    <span class="c1"># your code here</span>
    <span class="k">return</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>e) Bringing it all together</strong></p>
<p>Finally, we want to apply our functions to the King James Bible (<code>'bible-kjv.txt'</code>) that is part of the <code>gutenberg</code> corpus. We intend to find the word(s) that is (are) most similar to <code>god</code>. Follow the steps below:</p>
<p>i) Obtain a list of all tokens from the King James Bible and store it in a variable <code>tokens</code>.</p>
<p>ii) Clean the list of tokens with your function from <strong>a)</strong> to get the list of valid tokens (without removing stopwords) and store it in a variable <code>valid_tokens</code>.</p>
<p>iii) Apply your function from <strong>b)</strong> to count the context words for all valid tokens with a <code>context_size</code> of 2 and store the result in a variable <code>context_counts</code>.</p>
<p>iv) Using your function from <strong>c)</strong>, keep only the 20 most frequent words in a valid tokens context and store the result in a variable <code>context_words</code>.</p>
<p>v) Finally, find the most similar words to the word <em>god</em> with your function from <strong>d)</strong> and store the set of most similar words in the variable <code>set_god</code> and the highest Jaccard similarity in the variable <code>sim_god</code>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[&nbsp;]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">nltk</span>
<span class="n">nltk</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">'gutenberg'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># your code here</span>
</pre></div>

    </div>
</div>
</div>

</div>
    
